{
  "version": 3,
  "names": [
    "EVENTS",
    "usePointCollection",
    "props",
    "shape",
    "color",
    "size",
    "useMapContext",
    "map",
    "useState",
    "points",
    "setPoints",
    "pointCollection",
    "setPointCollection",
    "getPoints",
    "data",
    "result",
    "forEach",
    "item",
    "push",
    "BMap",
    "Point",
    "useEffect",
    "document",
    "createElement",
    "getContext",
    "opts",
    "BMAP_POINT_SIZE_SMALL",
    "BMAP_POINT_SHAPE_WATERDROP",
    "PointCollection",
    "addOverlay",
    "evnetName",
    "name",
    "replace",
    "toLowerCase",
    "addEventListener",
    "useVisiable",
    "useEventProperties",
    "useProperties"
  ],
  "sources": [
    "../src/usePointCollection.ts"
  ],
  "sourcesContent": [
    "import { useState, useEffect } from 'react';\nimport { useMapContext } from '@uiw/react-baidu-map-map';\nimport { useProperties, useVisiable, useEventProperties } from '@uiw/react-baidu-map-utils';\nimport { PointCollectionProps } from './';\n\nconst EVENTS = ['onClick', 'onMouseOver', 'onMouseOut'];\n\nexport interface UsePointCollection extends PointCollectionProps {}\n\nexport function usePointCollection(props = {} as UsePointCollection) {\n  const { shape, color, size } = props;\n  const { map } = useMapContext();\n  const [points, setPoints] = useState(props.points);\n  const [pointCollection, setPointCollection] = useState<BMap.PointCollection>();\n\n  const getPoints = (data: [number, number][] = []) => {\n    const result: BMap.Point[] = [];\n    data.forEach((item) => {\n      result.push(new BMap.Point(item[0], item[1]));\n    });\n    return result;\n  };\n  useEffect(() => {\n    if (!BMap || !map) return;\n    // 判断当前浏览器是否支持绘制海量点\n    if (document && !document.createElement('canvas').getContext) return;\n    const opts = { shape, color, size };\n    if (!pointCollection) {\n      if (!opts.size) opts.size = BMAP_POINT_SIZE_SMALL;\n      if (!opts.shape) opts.shape = BMAP_POINT_SHAPE_WATERDROP;\n      if (!opts.color) opts.color = '#d340c3';\n      const pointCollection = new BMap.PointCollection(getPoints(points), opts);\n      // pointCollection.clear();\n      map.addOverlay(pointCollection);\n      setPointCollection(pointCollection);\n      EVENTS.forEach((evnetName) => {\n        if ((props as any)[evnetName]) {\n          const name = evnetName.replace(/^on/, '').toLowerCase();\n          pointCollection.addEventListener(name, (props as any)[evnetName]);\n        }\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [map]);\n\n  useEffect(() => {\n    if (pointCollection && points) {\n      // pointCollection.clear();\n      pointCollection.setPoints(getPoints(points));\n    }\n  }, [points, pointCollection]);\n\n  useVisiable(pointCollection!, props);\n  useEventProperties<BMap.PointCollection, UsePointCollection>(pointCollection!, props, [\n    'onClick',\n    'onMouseOver',\n    'onMouseOut',\n  ]);\n  useProperties<BMap.PointCollection, UsePointCollection>(pointCollection!, props, ['Styles']);\n\n  return {\n    pointCollection,\n    setPointCollection,\n    points,\n    setPoints,\n  };\n}\n"
  ],
  "mappings": "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"
}